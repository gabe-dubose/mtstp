late.pupa.data <- late.pupa.data[!late.pupa.data$sample.id %in% non.late.ids,]
non.adult.ids <- metadata[metadata$developmental.stage != 'adult',]$sample.id
adult.data <- distances[,!names(distances) %in% non.adult.ids]
adult.data <- adult.data[!adult.data$sample.id %in% non.adult.ids,]
View(adult.data)
View(third.instar.data)
#run dbRDA for third instar
#partition actual distance matrix
third.distances <- third.instar.data[1:10]
View(third.distances)
#make model
third.dbRDA.model <- vegan::dbrda(formula = third.distances~genetic.background+plant.species, data=third.instar.data)
#run dbRDA for third instar
#partition actual distance matrix
third.distances <- third.instar.data[2:10]
View(third.distances)
View(third.instar.data)
#run dbRDA for third instar
#partition actual distance matrix
third.distances <- third.instar.data[2:11]
#partition data by developmental stage
non.third.ids <- metadata[metadata$developmental.stage != 'third-instar',]$sample.id
third.instar.data <- distances[,!names(distances) %in% non.third.ids]
third.instar.data <- third.instar.data[!third.instar.data$sample.id %in% non.third.ids,]
#run dbRDA for third instar
#partition actual distance matrix
third.distances <- third.instar.data[2:11]
#make model
third.dbRDA.model <- vegan::dbrda(formula = third.distances~genetic.background+plant.species, data=third.instar.data)
View(third.dbRDA.model)
#get model summary
third.dbRDA.model.summary <- summary(third.dbRDA.model)
#get model summary
third.dbRDA.model.summary <- summary(third.dbRDA.model)
third.dbRDA.model.summary
#perform anova and identify significant
anova(third.dbRDA.model.summary, by="terms", permu=999)
#perform anova and identify significant
anova(third.dbRDA.model, by="terms", permu=999)
#partition variance
third.variance.partitioned <- vegan::varpart(third.distances, ~genetic.background, ~plant.species, data=third.instar.data)
summary(third.variance.partitioned)
plot(third.variance.partitioned)
third.variance.partitioned.summary <- summary(third.variance.partitioned)
#write to file
write.csv(third.variance.partitioned.summary, '../data/text.csv')
third.variance.partitioned.summary <- data.frame(summary(third.variance.partitioned))
third.variance.partitioned.summary <- summary(third.variance.partitioned)
third.variance.partitioned.summary
third.variance.partitioned.summary$uniqpart
#get variance explained
third.explained <- data.frame(third.variance.partitioned.summary$uniqpart)
View(third.explained)
#get variance explained
third.explained <- third.variance.partitioned.summary$uniqpart
third.explained
third.explained["X1"]
third.dbRDA.model.summary
#perform anova and identify significant
third.dbRDA.anova <- anova(third.dbRDA.model, by="terms", permu=999)
third.dbRDA.anova
third.dbRDA.anova$`Pr(>F)`
third.dbRDA.anova$`Pr(>F)`[1]
#initialize dataframe to store data
rda.data <- data.frame(row.names = c("developmental.stage",
"explained.by.genetic.background",
"explained.by.plant",
"P"))
rda.data
View(rda.data)
#initialize dataframe to store data
rda.data <- data.frame(col.names = c("developmental.stage",
"explained.by.genetic.background",
"explained.by.plant",
"P"))
View(rda.data)
?data.frame
#initialize dataframe to store data
rda.data <- data.frame(row.names = c("developmental.stage",
"explained.by.genetic.background",
"explained.by.plant",
"P"))
rda.data
View(rda.data)
test <- c("1", "2", "34", "4")
rbind(rda.data, test)
View(rda.data)
rda.data <- rbind(rda.data, test)
View(rda.data)
?data.frame
#initialize dataframe to store data
rda.data <- data.frame(ncol = 4, col.names = c("developmental.stage",
"explained.by.genetic.background",
"explained.by.plant",
"P"))
View(rda.data)
third.dbRDA.anova$`Pr(>F)`
third.explained["X1"]
third.explained["X2"]
#initialize dataframe to store data
rda.data <- data.frame()
View(rda.data)
third.dbRDA.anova$`Pr(>F)`
third.dbRDA.anova$`Pr(>F)`[1]
#assemble data
third.rda.results <- c("third-instar", third.explained["X1"], third.explained["X2"], third.dbRDA.anova$`Pr(>F)`[1], third.dbRDA.anova$`Pr(>F)`[2])
third.rda.results
third.explained["X1"]
third.explained["X1"][0]
third.explained["X1"].value()
third.explained["X1"].value
third.explained["X1"].values
typeof(third.explained["X1"])
third.rda.results
rbind(rda.data, third.rda.results)
rda.data <- rbind(rda.data, third.rda.results)
View(rda.data)
View(third.instar.data)
#run dbRDA for third instar
#partition actual distance matrix
fifth.distances <- fifth.instar.data[2:11]
View(fifth.distances)
#make model
fifth.dbRDA.model <- vegan::dbrda(formula = fifth.distances~genetic.background+plant.species, data=fifth.instar.data)
#make model
fifth.dbRDA.model <- vegan::rda(formula = fifth.distances~genetic.background+plant.species, data=fifth.instar.data)
third.explained
#make model
third.dbRDA.model <- vegan::rda(formula = third.distances~genetic.background+plant.species, data=third.instar.data)
#get model summary
third.dbRDA.model.summary <- summary(third.dbRDA.model)
#perform anova and identify significant
third.dbRDA.anova <- anova(third.dbRDA.model, by="terms", permu=999)
third.dbRDA.anova$`Pr(>F)`[1]
#partition variance
third.variance.partitioned <- vegan::varpart(third.distances, ~genetic.background, ~plant.species, data=third.instar.data)
third.variance.partitioned.summary <- summary(third.variance.partitioned)
#get variance explained
third.explained <- third.variance.partitioned.summary$uniqpart
third.explained
#run dbRDA for third instar
#partition actual distance matrix
fifth.distances <- fifth.instar.data[2:11]
#make model
fifth.dbRDA.model <- vegan::rda(formula = fifth.distances~genetic.background+plant.species, data=fifth.instar.data)
#get model summary
fifth.dbRDA.model.summary <- summary(fifth.dbRDA.model)
fifth.dbRDA.model.summary
View(third.dbRDA.anova)
#perform anova and identify significant
fifth.dbRDA.anova <- anova(third.dbRDA.model, by="terms", permu=999)
#partition variance
fifth.variance.partitioned <- vegan::varpart(fifth.distances, ~genetic.background, ~plant.species, data=fifth.instar.data)
ffith.variance.partitioned.summary <- summary(fifth.variance.partitioned)
#get variance explained
fifth.explained <- fifth.variance.partitioned.summary$uniqpart
ffith.variance.partitioned.summary <- summary(fifth.variance.partitioned)
#get variance explained
fifth.explained <- fifth.variance.partitioned.summary$uniqpart
fifth.variance.partitioned.summary <- summary(fifth.variance.partitioned)
#get variance explained
fifth.explained <- fifth.variance.partitioned.summary$uniqpart
fifth.rda.results <- c("fifth-instar", fifth.explained["X1"], fifth.explained["X2"], fifth.dbRDA.anova$`Pr(>F)`[1], fifth.dbRDA.anova$`Pr(>F)`[2])
fifth.rda.results
rda.data.columns <- c("developmental.stage",
"explained.by.genetic.background",
"explained.by.plant",
"p.genetic.background",
"p.plant")
#run dbRDA for early pupa
#partition actual distance matrix
early.distances <- early.pupa.data[2:11]
View(early.distances)
#run dbRDA for early pupa
#partition actual distance matrix
early.distances <- early.pupa.data[2:10]
View(early.distances)
#make model
early.dbRDA.model <- vegan::rda(formula = early.distances~genetic.background+plant.species, data=early.instar.data)
#make model
early.dbRDA.model <- vegan::rda(formula = early.distances~genetic.background+plant.species, data=early.pupa.data)
#get model summary
early.dbRDA.model.summary <- summary(early.dbRDA.model)
#perform anova and identify significant
early.dbRDA.anova <- anova(early.dbRDA.model, by="terms", permu=999)
#partition variance
early.variance.partitioned <- vegan::varpart(early.distances, ~genetic.background, ~plant.species, data=early.pupa.data)
early.variance.partitioned.summary <- summary(early.variance.partitioned)
#get variance explained
early.explained <- early.variance.partitioned.summary$uniqpart
early.rda.results <- c("early-pupa", early.explained["X1"], early.explained["X2"], early.dbRDA.anova$`Pr(>F)`[1], early.dbRDA.anova$`Pr(>F)`[2])
early.rda.results
#run dbRDA for early pupa
#partition actual distance matrix
early.distances <- early.pupa.data[2:11]
View(early.distances)
#run dbRDA for late pupa
#partition actual distance matrix
late.distances <- late.pupa.data[2:11]
View(late.distances)
#run dbRDA for late pupa
#partition actual distance matrix
late.distances <- late.pupa.data[2:12]
View(late.distances)
#make model
late.dbRDA.model <- vegan::rda(formula = late.distances~genetic.background+plant.species, data=late.pupa.data)
#run dbRDA for late pupa
#partition actual distance matrix
late.distances <- late.pupa.data[2:11]
View(late.distances)
#make model
late.dbRDA.model <- vegan::rda(formula = late.distances~genetic.background+plant.species, data=late.pupa.data)
#get model summary
late.dbRDA.model.summary <- summary(late.dbRDA.model)
#perform anova and identify significant
late.dbRDA.anova <- anova(late.dbRDA.model, by="terms", permu=999)
#partition variance
late.variance.partitioned <- vegan::varpart(late.distances, ~genetic.background, ~plant.species, data=late.pupa.data)
late.variance.partitioned.summary <- summary(late.variance.partitioned)
#get variance explained
late.explained <- late.variance.partitioned.summary$uniqpart
late.rda.results <- c("late-pupa", late.explained["X1"], late.explained["X2"], late.dbRDA.anova$`Pr(>F)`[1], late.dbRDA.anova$`Pr(>F)`[2])
late.rda.results
#run dbRDA for adult
#partition actual distance matrix
adult.distances <- adult.pupa.data[2:11]
#run dbRDA for adult
#partition actual distance matrix
adult.distances <- adult.data[2:11]
View(adult.distances)
#run dbRDA for adult
#partition actual distance matrix
adult.distances <- adult.data[2:12]
#run dbRDA for adult
#partition actual distance matrix
adult.distances <- adult.data[2:11]
#make model
adult.dbRDA.model <- vegan::rda(formula = adult.distances~genetic.background+plant.species, data=adult.data)
#get model summary
adult.dbRDA.model.summary <- summary(adult.dbRDA.model)
#perform anova and identify significant
adult.dbRDA.anova <- anova(adult.dbRDA.model, by="terms", permu=999)
#partition variance
adult.variance.partitioned <- vegan::varpart(adult.distances, ~genetic.background, ~plant.species, data=adult.data)
adult.variance.partitioned.summary <- summary(adult.variance.partitioned)
#get variance explained
adult.explained <- adult.variance.partitioned.summary$uniqpart
adult.rda.results <- c("adult", adult.explained["X1"], adult.explained["X2"], adult.dbRDA.anova$`Pr(>F)`[1], adult.dbRDA.anova$`Pr(>F)`[2])
adult.rda.results
View(rda.data)
rda.data <- rbind(rda.data, fifth.rda.results)
rda.data <- rbind(rda.data, early.rda.results)
rda.data <- rbind(rda.data, late.rda.results)
rda.data <- rbind(rda.data, adult.rda.results)
#load distance matrix
distances <- read.csv('../data/distance_matricies/euclidian.csv')
#rename x to sampe.id
colnames(distances)[1] <- 'sample.id'
metadata <- read.csv('../data/mtstp_analysis_metadata.tsv', sep='\t')
#remove infected data
infected.ids <- metadata[metadata$infection.status == 'infected',]$sample.id
distances <- distances[,!names(distances) %in% infected.ids]
distances <- distances[!distances$sample.id %in% infected.ids,]
#add metadata categories
genetic.background <- c()
plant.species <- c()
developmental.stages <- c()
for (sample in distances$sample.id) {
plant <- metadata[metadata$sample.id == sample,]$plant
lineage <- metadata[metadata$sample.id == sample,]$lineage
stage <- metadata[metadata$sample.id == sample,]$developmental.stage
genetic.background <- c(genetic.background, lineage)
plant.species <- c(plant.species, plant)
developmental.stages <- c(developmental.stages, stage)
}
#add metadata to distance
distances <- cbind(distances, genetic.background)
distances <- cbind(distances, plant.species)
distances <- cbind(distances, developmental.stages)
#remove infected data
infected.ids <- metadata[metadata$infection.status == 'infected',]$sample.id
distances <- distances[,!names(distances) %in% infected.ids]
distances <- distances[!distances$sample.id %in% infected.ids,]
metadata <- metadata[metadata$infection.status != 'infected',]
#partition data by developmental stage
non.third.ids <- metadata[metadata$developmental.stage != 'third-instar',]$sample.id
third.instar.data <- distances[,!names(distances) %in% non.third.ids]
third.instar.data <- third.instar.data[!third.instar.data$sample.id %in% non.third.ids,]
non.fifth.ids <- metadata[metadata$developmental.stage != 'fifth-instar',]$sample.id
fifth.instar.data <- distances[,!names(distances) %in% non.fifth.ids]
fifth.instar.data <- fifth.instar.data[!fifth.instar.data$sample.id %in% non.fifth.ids,]
non.early.ids <- metadata[metadata$developmental.stage != 'early-pupa',]$sample.id
early.pupa.data <- distances[,!names(distances) %in% non.early.ids]
early.pupa.data <- early.pupa.data[!early.pupa.data$sample.id %in% non.early.ids,]
non.late.ids <- metadata[metadata$developmental.stage != 'late-pupa',]$sample.id
late.pupa.data <- distances[,!names(distances) %in% non.late.ids]
late.pupa.data <- late.pupa.data[!late.pupa.data$sample.id %in% non.late.ids,]
non.adult.ids <- metadata[metadata$developmental.stage != 'adult',]$sample.id
adult.data <- distances[,!names(distances) %in% non.adult.ids]
adult.data <- adult.data[!adult.data$sample.id %in% non.adult.ids,]
#initialize dataframe to store data
rda.data <- data.frame()
rda.data.columns <- c("developmental.stage",
"explained.by.genetic.background",
"explained.by.plant",
"p.genetic.background",
"p.plant")
#run dbRDA for third instar
#partition actual distance matrix
third.distances <- third.instar.data[2:11]
#make model
third.dbRDA.model <- vegan::rda(formula = third.distances~genetic.background+plant.species, data=third.instar.data)
#get model summary
third.dbRDA.model.summary <- summary(third.dbRDA.model)
#perform anova and identify significant
third.dbRDA.anova <- anova(third.dbRDA.model, by="terms", permu=999)
third.dbRDA.anova$`Pr(>F)`[1]
#partition variance
third.variance.partitioned <- vegan::varpart(third.distances, ~genetic.background, ~plant.species, data=third.instar.data)
third.variance.partitioned.summary <- summary(third.variance.partitioned)
#get variance explained
third.explained <- third.variance.partitioned.summary$uniqpart
#run dbRDA for fifth instar
#partition actual distance matrix
fifth.distances <- fifth.instar.data[2:11]
#make model
fifth.dbRDA.model <- vegan::rda(formula = fifth.distances~genetic.background+plant.species, data=fifth.instar.data)
#get model summary
fifth.dbRDA.model.summary <- summary(fifth.dbRDA.model)
#perform anova and identify significant
fifth.dbRDA.anova <- anova(third.dbRDA.model, by="terms", permu=999)
#partition variance
fifth.variance.partitioned <- vegan::varpart(fifth.distances, ~genetic.background, ~plant.species, data=fifth.instar.data)
fifth.variance.partitioned.summary <- summary(fifth.variance.partitioned)
#get variance explained
fifth.explained <- fifth.variance.partitioned.summary$uniqpart
#run dbRDA for early pupa
#partition actual distance matrix
early.distances <- early.pupa.data[2:10]
#make model
early.dbRDA.model <- vegan::rda(formula = early.distances~genetic.background+plant.species, data=early.pupa.data)
#get model summary
early.dbRDA.model.summary <- summary(early.dbRDA.model)
#perform anova and identify significant
early.dbRDA.anova <- anova(early.dbRDA.model, by="terms", permu=999)
#partition variance
early.variance.partitioned <- vegan::varpart(early.distances, ~genetic.background, ~plant.species, data=early.pupa.data)
early.variance.partitioned.summary <- summary(early.variance.partitioned)
#get variance explained
early.explained <- early.variance.partitioned.summary$uniqpart
#run dbRDA for late pupa
#partition actual distance matrix
late.distances <- late.pupa.data[2:11]
#make model
late.dbRDA.model <- vegan::rda(formula = late.distances~genetic.background+plant.species, data=late.pupa.data)
#get model summary
late.dbRDA.model.summary <- summary(late.dbRDA.model)
#perform anova and identify significant
late.dbRDA.anova <- anova(late.dbRDA.model, by="terms", permu=999)
#partition variance
late.variance.partitioned <- vegan::varpart(late.distances, ~genetic.background, ~plant.species, data=late.pupa.data)
late.variance.partitioned.summary <- summary(late.variance.partitioned)
#get variance explained
late.explained <- late.variance.partitioned.summary$uniqpart
#run dbRDA for adult
#partition actual distance matrix
adult.distances <- adult.data[2:11]
#make model
adult.dbRDA.model <- vegan::rda(formula = adult.distances~genetic.background+plant.species, data=adult.data)
#get model summary
adult.dbRDA.model.summary <- summary(adult.dbRDA.model)
#perform anova and identify significant
adult.dbRDA.anova <- anova(adult.dbRDA.model, by="terms", permu=999)
#partition variance
adult.variance.partitioned <- vegan::varpart(adult.distances, ~genetic.background, ~plant.species, data=adult.data)
adult.variance.partitioned.summary <- summary(adult.variance.partitioned)
#get variance explained
adult.explained <- adult.variance.partitioned.summary$uniqpart
#assemble data
third.rda.results <- c("third-instar", third.explained["X1"], third.explained["X2"], third.dbRDA.anova$`Pr(>F)`[1], third.dbRDA.anova$`Pr(>F)`[2])
fifth.rda.results <- c("fifth-instar", fifth.explained["X1"], fifth.explained["X2"], fifth.dbRDA.anova$`Pr(>F)`[1], fifth.dbRDA.anova$`Pr(>F)`[2])
early.rda.results <- c("early-pupa", early.explained["X1"], early.explained["X2"], early.dbRDA.anova$`Pr(>F)`[1], early.dbRDA.anova$`Pr(>F)`[2])
late.rda.results <- c("late-pupa", late.explained["X1"], late.explained["X2"], late.dbRDA.anova$`Pr(>F)`[1], late.dbRDA.anova$`Pr(>F)`[2])
adult.rda.results <- c("adult", adult.explained["X1"], adult.explained["X2"], adult.dbRDA.anova$`Pr(>F)`[1], adult.dbRDA.anova$`Pr(>F)`[2])
rda.data <- rbind(rda.data, third.rda.results)
rda.data <- rbind(rda.data, fifth.rda.results)
rda.data <- rbind(rda.data, early.rda.results)
rda.data <- rbind(rda.data, late.rda.results)
rda.data <- rbind(rda.data, adult.rda.results)
View(rda.data)
colnames(rda.data) <- rda.data.columns
View(rda.data)
write.csv(rda.data, '../data/variance_paritioned.csv')
write.csv(rda.data, '../data/variance_paritioned.csv', index=FALSE)
write.csv?
?write.csv
?write.csv
write.csv(rda.data, '../data/variance_paritioned.csv', row.names=FALSE)
#load distance matrix
distances <- read.csv('../data/distance_matricies/euclidian.csv')
View(distances)
#load distance matrix
distances <- read.csv('../data/distance_matricies/euclidian.csv')
#rename x to sampe.id
colnames(distances)[1] <- 'sample.id'
metadata <- read.csv('../data/mtstp_analysis_metadata.tsv', sep='\t')
#remove infected data
infected.ids <- metadata[metadata$infection.status == 'infected',]$sample.id
distances <- distances[,!names(distances) %in% infected.ids]
distances <- distances[!distances$sample.id %in% infected.ids,]
#add metadata categories
genetic.background <- c()
View(distances)
#load distance matrix
distances <- read.csv('../data/distance_matricies/euclidian.csv')
#rename x to sampe.id
colnames(distances)[1] <- 'sample.id'
metadata <- read.csv('../data/mtstp_analysis_metadata.tsv', sep='\t')
#remove infected data
infected.ids <- metadata[metadata$infection.status == 'infected',]$sample.id
distances <- distances[,!names(distances) %in% infected.ids]
distances <- distances[!distances$sample.id %in% infected.ids,]
View(distances)
#run PCA
uninf.pca <- pca(distances)
#run PCA
uninf.pca <- princomp(distances)
View(distances)
matrix(distances)
#remove sample id column
distances <- distances[2:]
#remove sample id column
distances <- distances[2:,]
#remove sample id column
distances <- distances[2:11]
View(distances)
length(distances)
#load distance matrix
distances <- read.csv('../data/distance_matricies/euclidian.csv')
#rename x to sampe.id
colnames(distances)[1] <- 'sample.id'
metadata <- read.csv('../data/mtstp_analysis_metadata.tsv', sep='\t')
#remove infected data
infected.ids <- metadata[metadata$infection.status == 'infected',]$sample.id
distances <- distances[,!names(distances) %in% infected.ids]
distances <- distances[!distances$sample.id %in% infected.ids,]
#remove sample id column
distances <- distances[2:length(distances)]
View(distances)
#run PCA
uninf.pca <- princomp(distances)
View(uninf.pca)
plot(uninf.pca)
biplot(uninf.pca)
uninf.pca$
uninf.pca$loadings
uninf.pca$loadings
#load distance matrix
distances <- read.csv('../data/distance_matricies/euclidian.csv')
View(distances)
#run PCA
uninf.pca <- princomp(distances)
#remove sample id column
distances <- as.matrix(distances[2:length(distances)])
#load distance matrix
distances <- read.csv('../data/distance_matricies/euclidian.csv')
#rename x to sampe.id
colnames(distances)[1] <- 'sample.id'
metadata <- read.csv('../data/mtstp_analysis_metadata.tsv', sep='\t')
#remove infected data
infected.ids <- metadata[metadata$infection.status == 'infected',]$sample.id
distances <- distances[,!names(distances) %in% infected.ids]
distances <- distances[!distances$sample.id %in% infected.ids,]
#remove sample id column
distances <- matrix(distances[1:length(distances)])
#run PCA
uninf.pca <- princomp(distances)
#load distance matrix
distances <- read.csv('../data/distance_matricies/euclidian.csv')
#rename x to sampe.id
colnames(distances)[1] <- 'sample.id'
metadata <- read.csv('../data/mtstp_analysis_metadata.tsv', sep='\t')
#remove infected data
infected.ids <- metadata[metadata$infection.status == 'infected',]$sample.id
distances <- distances[,!names(distances) %in% infected.ids]
distances <- distances[!distances$sample.id %in% infected.ids,]
#remove sample id column
distances <- t(distances[2:length(distances)])
#run PCA
uninf.pca <- princomp(distances)
biplot(uninf.pca)
uninf.pca$loadings
uninf.pca$x
uninf.pca$scale
uninf.pca$call
uninf.pca$x
#run PCA
uninf.pca <- prcomp(distances)
uninf.pca$x
pca.coords <- data.frame(uninf.pca$x)
View(pca.coords)
#write PCA results
write.csv(pca.coords, '../data/uninfected_pca.csv')
uninf.pca$x
uninf.pca$sdev
#print summary
summary(uninf.pca)
6.116e-01
#print summary
print(summary(uninf.pca))
#write PCA results
write.csv(pca.coords, '../data/uninfected_pca.csv')
